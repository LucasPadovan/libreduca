<% if @teach.scores.empty? %>
  <div class="alert"><%= t('view.teaches.without_scores.html') %></div>
<% else %>
  <% grouped_scores = teach_scores_grouped_by_student(@teach) %>
  <table class="table table-striped table-bordered table-condensed">
    <thead>
      <tr>
        <th><%= Score.human_attribute_name 'user_id' %></th>
        <th colspan="<%= grouped_scores.first.last.size %>"></th>
      </tr>
    </thead>
    <tbody>
      <% grouped_scores.each do |user, scores| %>
        <%= content_for :modal_dialogs do %>
          <%= render partial: 'email_enrollment_score_dialog', locals: {
            user: user, enrollment: @teach.enrollment_for(user)
          } %>
        <% end %>
        <tr>
          <td>
            <%= link_to(
              '&#x2709;'.html_safe, "#email_modal_#{user.id}",
              class: 'iconic', data: { toggle: 'modal' }
            ) if can? :send_email_summary, @teach.enrollment_for(user) %>
            <%= user %>
          </td>
          <% scores.each do |score| %>
            <td><%= show_teach_score_details score %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
<%= yield :modal_dialogs %>
